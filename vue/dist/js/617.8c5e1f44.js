"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[617],{3617:function(t,e,n){n.r(e),n.d(e,{default:function(){return g}});var i=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"60%",margin:"10px auto"}},[e("div",{staticClass:"card",staticStyle:{"margin-bottom":"10px"}},[e("div",{staticStyle:{"font-size":"24px","font-weight":"bold","text-align":"center","margin-bottom":"10px"}},[t._v(t._s(t.news.title)+" ")]),e("div",{staticStyle:{"text-align":"center",color:"#888","margin-bottom":"20px"}},[e("span",[t._v("发布时间："+t._s(t.news.time))]),e("span",{staticStyle:{"margin-left":"20px"}},[t._v("浏览量："+t._s(t.news.readCount))])]),e("div",{staticClass:"w-e-text"},[e("div",{domProps:{innerHTML:t._s(t.news.content)}})])]),e("div",{staticClass:"card"},[e("Comment",{attrs:{fid:t.id,module:"news"}})],1)])},s=[],a=(n(7438),function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{"margin-bottom":"20px","font-size":"22px","font-weight":"bold"}},[t._v("评论 "+t._s(t.commentCount))]),e("div",{staticStyle:{"margin-bottom":"20px"}},[e("el-input",{attrs:{type:"textarea",placeholder:"请输入评论"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(null)}}},[t._v("评论")])],1)],1),e("div",[t._l(t.commentList,(function(n){return e("div",{key:n.id,staticStyle:{"margin-bottom":"20px"}},[e("div",{staticStyle:{display:"flex","margin-bottom":"20px"}},[e("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:n.avatar,alt:""}}),e("div",{staticStyle:{"padding-left":"15px",flex:"1"}},[e("div",{staticStyle:{"margin-bottom":"10px",color:"#666"}},[t._v(t._s(n.userName))]),e("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(t._s(n.content))]),e("div",{staticStyle:{color:"#666","font-size":"13px","margin-bottom":"5px"}},[e("span",[t._v(t._s(n.time))]),e("span",{class:{"comment-active":n.showReply},staticStyle:{margin:"0 20px",cursor:"pointer"},on:{click:function(e){return t.handleShowReply(n)}}},[e("i",{staticClass:"el-icon-s-comment"}),t._v("回复")]),n.userId===t.user.id?e("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delComment(n.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()]),n.showReply?e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"请输入回复"},model:{value:n.replyContent,callback:function(e){t.$set(n,"replyContent",e)},expression:"item.replyContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(n)}}},[t._v("回复")])],1)],1):t._e()])]),n.children?e("div",{staticStyle:{"padding-left":"65px"}},t._l(n.children,(function(i){return e("div",{staticStyle:{display:"flex","margin-bottom":"20px"}},[e("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:i.avatar,alt:""}}),e("div",{staticStyle:{"padding-left":"15px",flex:"1"}},[e("div",{staticStyle:{"margin-bottom":"10px",color:"#666"}},[t._v(t._s(i.userName)+" "),i.parentUserName!==n.userName?e("span",[t._v("回复："+t._s(i.parentUserName))]):t._e()]),e("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(t._s(i.content))]),e("div",{staticStyle:{color:"#666","font-size":"13px","margin-bottom":"5px"}},[e("span",[t._v(t._s(i.time))]),e("span",{class:{"comment-active":i.showReply},staticStyle:{margin:"0 20px",cursor:"pointer"},on:{click:function(e){return t.handleShowReply(i)}}},[e("i",{staticClass:"el-icon-s-comment"}),t._v("回复")]),i.userId===t.user.id?e("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delComment(i.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()]),i.showReply?e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"请输入回复"},model:{value:i.replyContent,callback:function(e){t.$set(i,"replyContent",e)},expression:"sub.replyContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(i)}}},[t._v("回复")])],1)],1):t._e()])])})),0):t._e()])})),t.total>t.pageSize?e("div",{staticStyle:{"margin-top":"10px"}},[e("el-pagination",{attrs:{small:"",background:"","current-page":t.pageNum,"page-sizes":[5,10,20],"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1):t._e()],2)])}),o=[],l={name:"CommentComponent",props:{fid:null,module:null},data(){return{user:JSON.parse(localStorage.getItem("xm-user")||"{}"),commentCount:0,content:"",commentList:[],pageNum:1,pageSize:5,total:0}},created(){this.loadComment()},methods:{handleShowReply(t){this.$set(t,"showReply",!t.showReply)},delComment(t){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/comment/delete/"+t).then((t=>{"200"===t.code?(this.$message.success("操作成功"),this.loadComment()):this.$message.error(t.msg)}))})).catch((()=>{}))},loadComment(){this.$request.get("/comment/selectTree/"+this.fid+"/"+this.module,{params:{pageNum:this.pageNum,pageSize:this.pageSize}}).then((t=>{this.commentList=t.data?.list||[],this.total=t.data?.total||0})),this.$request.get("/comment/selectCount/"+this.fid+"/"+this.module).then((t=>{this.commentCount=t.data||0}))},addComment(t){let e={fid:this.fid,userId:this.user.id,module:this.module,content:this.content};t&&(e.content=t.replyContent,e.pid=t.id),e.content?this.$request.post("/comment/add",e).then((t=>{"200"===t.code?(this.$message.success("操作成功"),this.content="",this.loadComment()):this.$message.error(t.msg)})):this.$message.warning("请输入内容!")},handleCurrentChange(t){this.pageNum=t,this.loadComment()}}},r=l,c=n(3736),m=(0,c.Z)(r,a,o,!1,null,"31877cfe",null),d=m.exports,p={name:"NewsDetail",components:{Comment:d},data(){return{id:this.$route.query.id,news:{}}},created(){this.$request.put("/news/updateCount/"+this.id).then((()=>{this.load()}))},methods:{load(){this.$request.get("/news/selectById/"+this.id).then((t=>{this.news=t.data||{}}))}}},u=p,h=(0,c.Z)(u,i,s,!1,null,"477b2bd6",null),g=h.exports}}]);
//# sourceMappingURL=617.8c5e1f44.js.map